@startuml Murex Data Transformation Service - Architecture
!theme vibrant

' Define custom colors
!define PRESENTATION_COLOR #E3F2FD
!define APPLICATION_COLOR #FFF3E0
!define DOMAIN_COLOR #F3E5F5
!define INFRASTRUCTURE_COLOR #FCE4EC
!define DATASTORE_COLOR #E0F2F1

skinparam backgroundColor white
skinparam shadowing false
skinparam defaultFontName Arial
skinparam defaultFontSize 12

title Murex Data Transformation Service - High-Level Architecture

' External Systems
actor "External\nClient" as client #LightGray
cloud "Downstream\nSystems" as downstream #LightGray

' Presentation Layer
package "Presentation Layer" PRESENTATION_COLOR {
    [REST Controller\nSpring MVC] as controller
    [OpenAPI 3.0\nSwagger UI] as swagger
}

' Application Layer
package "Application Layer" APPLICATION_COLOR {
    [Orchestration Service\nWorkflow Engine] as orchestration
    [Strategy Factory\nDesign Pattern] as factory
}

' Domain Layer - Strategies
package "Domain Layer - Strategies" DOMAIN_COLOR {
    [FX Spot\nStrategy] as spot
    [FX Swap\nStrategy] as swap
    [FX NDF\nStrategy] as ndf
}

' Domain Layer - Services
package "Domain Layer - Services" DOMAIN_COLOR {
    [Validation\nService] as validation
    [Transformation\nEngine] as transformation
    [DMC Generation\nService] as dmc
}

' Infrastructure Layer
package "Infrastructure Layer" INFRASTRUCTURE_COLOR {
    [JDBC Repository\nTemplate Pattern] as repository
    [FreeMarker\nSQL Templates] as freemarker
    [Kafka Producer\nEvent Publisher] as kafka_producer
    [MapStruct\nDTO Mappers] as mapstruct
}

' Data Store
package "Data Store" DATASTORE_COLOR {
    database "MariaDB\nTransactional DB" as mariadb
    queue "Apache Kafka\nMessage Broker" as kafka_broker
}

' Connections
client --> controller : HTTPS/REST
controller --> swagger : API Docs
controller --> orchestration : Delegate

orchestration --> factory : Select Strategy
factory ..> spot : Creates
factory ..> swap : Creates
factory ..> ndf : Creates

spot --> validation
swap --> validation
ndf --> validation

validation --> transformation
transformation --> dmc

dmc --> repository
repository --> freemarker
freemarker --> mariadb

dmc --> mapstruct
mapstruct --> kafka_producer
kafka_producer --> kafka_broker
kafka_broker --> downstream

@enduml
